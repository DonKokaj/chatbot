<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Page</title>
    <style>
        /* Hide the default chatbot button */
        .vf-floating-button {
            display: none;
        }

        /* Style for the UK flag button */
        .icon-button {
            background-color: transparent;
            border: none;
            cursor: pointer;
        }

        .icon-button img {
            width: 32px;
            height: 32px;
        }
    </style>
</head>
<body>

    <!-- UK Flag button -->
    <button class="icon-button" onclick="openChat()">
        <img src="https://image.similarpng.com/very-thumbnail/2020/06/United-Kingdom-flag-icon-on-transparent-background-PNG.png" alt="UK Flag">
    </button>

    <script type="text/javascript">
        // Load Voiceflow Chat Widget
        (function(d, t) {
            var v = d.createElement(t), s = d.getElementsByTagName(t)[0];
            v.onload = function() {
                window.voiceflow.chat.load({
                    verify: { projectID: '66a0c7c261762753caa83435' },
                    url: 'https://general-runtime.voiceflow.com',
                    versionID: 'production'
                });
            }
            v.src = "https://cdn.voiceflow.com/widget/bundle.mjs"; 
            v.type = "text/javascript"; 
            s.parentNode.insertBefore(v, s);
        })(document, 'script');

        // Function to open the chat window when the flag button is clicked
        function openChat() {
            if (window.voiceflow && window.voiceflow.chat) {
                window.voiceflow.chat.open();

                // Try to click the "Start New Chat" button after 3 seconds
                setTimeout(function() {
                    try {
                        const startChatButton = document.querySelector("#voiceflow-chat")
                            .shadowRoot.querySelector("div > div.vfrc-widget--chat.c-fikloo > div > article > footer > button");
                        if (startChatButton) {
                            startChatButton.click();
                            console.log("Clicked the 'Start New Chat' button.");
                        } else {
                            console.log("'Start New Chat' button not found.");
                        }
                    } catch (error) {
                        console.error("Error finding or clicking the 'Start New Chat' button:", error);
                    }
                }, 3000); // 3-second delay before trying to click the "Start New Chat" button

                // Try to click the second button after 5 seconds (3s delay + 2s more)
                setTimeout(function() {
                    try {
                        const secondButton = document.querySelector("#voiceflow-chat")
                            .shadowRoot.querySelector("div > div.vfrc-widget--chat.c-fikloo > div > article > main > div.vfrc-system-response.c-gSBsRr.c-gSBsRr-jjOUdr-withImage-true.c-gSBsRr-dCAjaq-scrollable-true.vfrc-system-response--message.PJLV > div.vfrc-system-response--list.c-iTxaCK > div > section:nth-child(2) > main > button");
                        if (secondButton) {
                            secondButton.click();
                            console.log("Clicked the second button.");
                        } else {
                            console.log("Second button not found.");
                        }
                    } catch (error) {
                        console.error("Error finding or clicking the second button:", error);
                    }
                }, 5000); // 5-second delay before trying to click the second button
            } else {
                console.log("Voiceflow chat not loaded yet.");
            }
        }
    </script>


    <script>
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "xageq0xv",
        user_id: user.id, // IMPORTANT: Replace "user.id" with the variable you use to capture the user's ID
        name: user.name, // IMPORTANT: Replace "user.name" with the variable you use to capture the user's name
        email: user.email, // IMPORTANT: Replace "user.email" with the variable you use to capture the user's email address
        created_at: user.createdAt, // IMPORTANT: Replace "user.createdAt" with the variable you use to capture the user's sign-up date
      };
    </script>
    
    
    <script>
      // We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/xageq0xv'
      (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/xageq0xv';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
    </script>

</body>
</html>
